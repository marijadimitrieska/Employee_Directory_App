@model Employee_Directory_App.ViewModels.EmployeeViewModel

@{
    ViewData["Title"] = "Create";
}

<h1>Create</h1>

<h4>Employee</h4>
<hr />
<div class="row">
    <div class="col-md-4">
        <form asp-action="Create" id="EmployeeForm" enctype="multipart/form-data">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                        <div class="form-group">
                            <label asp-for="Employee.FirstName"></label>
                            <input asp-for="Employee.FirstName" class="k-textbox" />
                            <span asp-validation-for="Employee.FirstName" class="text-danger k-invalid-msg" data-for="Employee.FirstName"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="Employee.LastName"></label>
                            <input asp-for="Employee.LastName" class="k-textbox" />
                            <span asp-validation-for="Employee.LastName" class="text-danger k-invalid-msg" data-for="Employee.LastName"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="Employee.Email"></label>
                            <input asp-for="Employee.Email" class="k-textbox" />
                            <span asp-validation-for="Employee.Email" class="text-danger k-invalid-msg" data-for="Employee.Email"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="Employee.PhoneNumber"></label>
                            <input asp-for="Employee.PhoneNumber" class="k-textbox" />
                            <span asp-validation-for="Employee.PhoneNumber" class="text-danger k-invalid-msg" data-for="Employee.PhoneNumber"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="Employee.HireDate"></label>
                            <kendo-datetimepicker for="Employee.HireDate" />
                            <span asp-validation-for="Employee.HireDate" class="text-danger k-invalid-msg" data-for="Employee.HireDate"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="Employee.DepartmentId"></label>
                            <select asp-for="Employee.DepartmentId" asp-items="ViewBag.DepartmentId"></select>
                        </div>
                        <div class="form-group">
                            <label asp-for="Employee.JobTitleId"></label>
                            <select asp-for="Employee.JobTitleId" asp-items="ViewBag.JobTitleId"></select>
                        </div>
                        <div class="form-group">
                            <label asp-for="Employee.ProfilePhoto">Upload Image</label>

                            @(Html.Kendo().Upload()
                                .Name("ImageFile")
                                .Multiple(false)
                                .Async(a => a
                                        .Save("SaveTempImage", "Employees")
                                        .AutoUpload(true))
                                        .Validation(v=>v
                                            .AllowedExtensions(new string[] { ".jpg", ".jpeg", ".png", ".gif"})
                                            .MaxFileSize(5242880)
                                        )
                               
                                .Events(e=>e
                                .Success("onUploadSuccess")
                                .Error("onUploadError")
                                )
                            )
                            <div id="imagePreview"  style="margin-top:20px;"></div>
                        </div>
                        <div class="form-group">
                            @Html.Kendo().CheckBoxFor(m => m.Employee.IsActive)
                            <label asp-for="Employee.IsActive"></label>
                            <span asp-validation-for="Employee.IsActive" class="text-danger k-invalid-msg" data-for="Employee.IsActive"></span>
                        </div>
<div class="form-group">
    <input type="submit" value="Create" class="k-button k-button-md k-rounded-md k-button-solid-primary" />
</div>
</form>
</div>
</div>

<div>
    <a asp-action="Index" class="k-button k-button-md k-rounded-md k-button-solid">Back to List</a>
</div>


    <script>
        function onUploadSuccess(e)
        {
            console.log("Upload successful", e);

            if(e.response && e.response.success)
            {
                $("#imagePreview").html("<p class='text-success'>Image upload successfully!</p>");
            }
        }
        function onUploadError(e){
            console.log("Upload error", e;
            $("#imagePreview").html("<p class='text-danger'>Upload failed: " + (e.XMLHttpRequest.responseText || "Unknown error") + "</p>");
        }
        $(document).ready(function () {
            $("#EmployeeForm").kendoValidator({
                // You can define your custom rules here:
                //rules: {}
            });
        })
    </script>
